<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Tarefa4_2022li1g079</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption empty">&nbsp;</span><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Leonor Cunha &lt;a103997@alunos.uminho.pt&gt;<br />Tiago Barros &lt;a104530@alunos.uminho.pt&gt;</td></tr><tr><th>Safe Haskell</th><td>Safe</td></tr></table><p class="caption">Tarefa4_2022li1g079</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>M&#243;dulo para a realiza&#231;&#227;o da Tarefa 4 do projeto de LI1 em 2022/23.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:jogoTerminou">jogoTerminou</a> :: <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> -&gt; Bool</li><li class="src short"><a href="#v:jogoTerminoumapa">jogoTerminoumapa</a> :: <a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a> -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Bool</li><li class="src short"><a href="#v:jogoTerminouAgua">jogoTerminouAgua</a> :: <a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a> -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Bool</li><li class="src short"><a href="#v:ondenaoTronco">ondenaoTronco</a> :: (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; <a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a> -&gt; [<a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a>]</li><li class="src short"><a href="#v:jogoTerminouCarro">jogoTerminouCarro</a> :: <a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a> -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Bool</li><li class="src short"><a href="#v:ondeCarro">ondeCarro</a> :: (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; <a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a> -&gt; [<a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a>]</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:jogoTerminou" class="def">jogoTerminou</a> :: <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> -&gt; Bool <a href="#v:jogoTerminou" class="selflink">#</a></p><div class="doc"><p>A fun&#231;ao jogoTerminou verifica se o jogador terminou o jogo ou nao de acordo com: as coordenadas nao coicidirem com os limites do mapa, estar em nenhum no terreno rio e ter as mesmas coordenadas que um carro no terreno estrada.
Assim utiliza tres fun&#231;oes auxiliares definidas a baixo para determinar a sua validade.
<code>jogoTerminou :: Jogo -&gt; Bool
jogoTerminou (Jogo (Jogador (x,y)) (Mapa c ((tr, (x':y')):t))) = jogoTerminoumapa (x,y) (Mapa c ((tr, (x':y')):t)) || jogoTerminouAgua (x,y) (Mapa c ((tr, (x':y')):t)) || jogoTerminouCarro (x,y) (Mapa c ((tr, (x':y')):t))
</code></p></div></div><div class="top"><p class="src"><a id="v:jogoTerminoumapa" class="def">jogoTerminoumapa</a> :: <a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a> -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Bool <a href="#v:jogoTerminoumapa" class="selflink">#</a></p><div class="doc"><p>A fun&#231;ao jogoTerminoumapa verifica se o jogador/ personagem se encontra fora dos limites do mapa. Assim, recebe as coordenadas do jogador, o mapa para compara&#231;ao e devolve um Bool. Caso seja True, o jogador perdeu o jogo.
Comparamos: o x (posi&#231;ao do jogador na linha- verticalmente) com a largura do mapa, ou seja, quantos obstaculos estao definidos; o y (posi&#231;ao do jogador na coluna- horizontalmente) com o comprimento da lista de [Terreno, (Obstaculos)] (quantos terrenos existem). 
Como a primeira posi&#231;ao &#233; 0 e nao 1, usamos o &gt;= (maior ou igual) pois no caso de serem iguais o jogador estara fora do mapa. 
Basta uma das coordenadas estar fora do mapa para o jogador perder entao usamos || que &#233; ou. Se alguma das condi&#231;oes for verdadeira a fun&#231;ao ser&#225; verdadeira o que significa que o jogador perdeu, caso contr&#225;rio &#233; falso, continua o jogo.
<code>jogoTerminoumapa :: Coordenadas -&gt; Mapa -&gt; Bool
jogoTerminoumapa (x,y) (Mapa c ((tr, (x':y')):t)) | x &gt;= c || y &gt;= length ((tr, (x':y')):t) = True
                                                  | otherwise = False
</code></p></div></div><div class="top"><p class="src"><a id="v:jogoTerminouAgua" class="def">jogoTerminouAgua</a> :: <a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a> -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Bool <a href="#v:jogoTerminouAgua" class="selflink">#</a></p><div class="doc"><p>A fun&#231;ao jogoTerminouAgua determina se o jogo termina pois o jogador caiu na agua ou nao.
Se o primeiro terreno for rio, utilizando uma fun&#231;ao auxiliar (ondeTronco) que indica as coordenadas todas de onde nao ha tronco no mapa, ou seja, onde tem Nenhum, a fun&#231;ao ir&#225; procurar se nas coordenadas dadas (do jogador) existe nessas coordenadas um tronco.
Caso exista um tronco nessas coordenadas, o jogador nao morre, ou seja false. De seguida verifica o resto da fun&#231;ao mas com as coordenadas (x,y-1) pois a linha analid&#161;sada com o movimento do mapa desaparece e passamos para a seguinte.
Quando a fun&#231;ao encontra os terrenos estrada ou relva, procura no resto do mapa pelo rio, caso haja.
@jogoTerminouAgua :: Coordenadas -&gt; Mapa -&gt; Bool
jogoTerminouAgua (x,y) (Mapa c []) = False
jogoTerminouAgua (x,y) (Mapa c ((Rio n, (x' :y')):t)) = if elem (x,y) (ondenaoTronco (Rio n, (x': y')) (0,0)) then True else jogoTerminouAgua (x,y-1) (Mapa c t)  
jogoTerminouAgua (x,y) (Mapa c ((Estrada n, (x' :y')):t)) = jogoTerminouAgua (x,y-1) (Mapa c t)
jogoTerminouAgua (x,y) (Mapa c ((Relva , (x' :y')):t)) = jogoTerminouAgua (x,y-1) (Mapa c t)</p><p>ondenaoTronco :: (Terreno, [Obstaculo]) -&gt; Coordenadas -&gt; [Coordenadas]
ondenaoTronco (Rio n, []) (x,y) = []
ondenaoTronco (Rio n, (x':y')) (x,y) = if x' == Nenhum then (x,y) : ondenaoTronco (Rio n, y') (x+1, y) else ondenaoTronco (Rio n, y') (x+1, y)
@</p></div></div><div class="top"><p class="src"><a id="v:ondenaoTronco" class="def">ondenaoTronco</a> :: (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; <a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a> -&gt; [<a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a>] <a href="#v:ondenaoTronco" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:jogoTerminouCarro" class="def">jogoTerminouCarro</a> :: <a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a> -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Bool <a href="#v:jogoTerminouCarro" class="selflink">#</a></p><div class="doc"><p>A semelhan&#231;a da fun&#231;ao anterior, a fun&#231;ao jogoTerminouCarro verifica se o jogador se encontra nas mesmas coordenadas que um carro, ou seja &#233; atropelado ou nao.
Tambem utiliza uma fun&#231;ao auxiliar que d&#225; as coordenadas dos carros (ondeCarro).
Neste caso, compara as coordenadas do jogador com as coordenadas obtidas na fun&#231;ao auxiliar mas no caso de coicidirem, o jogo termina pois o jogador &#233; atropelado.
No caso do terreno ser rio ou relva a fun&#231;ao analisa o resto do mapa, comparando com as coordenada do jogador, onde o terreno for estrada.
@jogoTerminouCarro :: Coordenadas -&gt; Mapa -&gt; Bool
jogoTerminouCarro (x,y) (Mapa c []) = False
jogoTerminouCarro (x,y) (Mapa c ((Estrada n, (x' :y')):t)) = if elem (x,y) (ondeCarro (Estrada n, (x': y')) (0,0)) then True else jogoTerminouCarro (x,y-1) (Mapa c t)  
jogoTerminouCarro (x,y) (Mapa c ((Rio n, (x' :y')):t)) = jogoTerminouCarro (x,y-1) (Mapa c t)
jogoTerminouCarro (x,y) (Mapa c ((Relva , (x' :y')):t)) = jogoTerminouCarro (x,y-1) (Mapa c t)</p><p>ondeCarro :: (Terreno, [Obstaculo]) -&gt; Coordenadas -&gt; [Coordenadas]
ondeCarro (Estrada n, []) (x,y) = []
ondeCarro (Estrada n, (x':y')) (x,y) = if x' == Carro then (x,y) : ondeCarro (Estrada n, y') (x+1, y) else ondeCarro (Estrada n, y') (x+1, y)@</p></div></div><div class="top"><p class="src"><a id="v:ondeCarro" class="def">ondeCarro</a> :: (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; <a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a> -&gt; [<a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a>] <a href="#v:ondeCarro" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.23.0</p></div></body></html>